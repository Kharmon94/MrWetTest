<% content_for :title, "Create New Course - Sea Pass Pro" %>

<div class="container py-4">
  <div class="row justify-content-center">
    <div class="col-lg-8">
      <!-- Header -->
      <div class="d-flex align-items-center mb-4">
        <%= link_to instructor_courses_path, class: "btn btn-outline-secondary me-3" do %>
          <i class="fas fa-arrow-left"></i>
        <% end %>
        <div>
          <h1 class="h3 mb-1 text-primary">
            <i class="fas fa-plus me-2"></i>
            Create New Course
          </h1>
          <p class="text-muted mb-0">Build a comprehensive maritime education course</p>
        </div>
      </div>

      <!-- Course Form -->
      <div class="card shadow">
        <div class="card-body">
          <%= form_with model: @course, url: instructor_courses_path, local: true, multipart: true, class: "needs-validation", novalidate: true do |form| %>
            <% if @course.errors.any? %>
              <div class="alert alert-danger">
                <h6>Please fix the following errors:</h6>
                <ul class="mb-0">
                  <% @course.errors.full_messages.each do |message| %>
                    <li><%= message %></li>
                  <% end %>
                </ul>
              </div>
            <% end %>

            <!-- Basic Information -->
            <div class="row mb-4">
              <div class="col-12">
                <h5 class="text-primary mb-3">
                  <i class="fas fa-info-circle me-2"></i>
                  Basic Information
                </h5>
              </div>
            </div>

            <div class="row mb-3">
              <div class="col-12">
                <%= form.label :title, "Course Title", class: "form-label" %>
                <%= form.text_field :title, 
                    class: "form-control #{'is-invalid' if @course.errors[:title].any?}",
                    placeholder: "e.g., Maritime Safety Fundamentals",
                    required: true %>
                <div class="invalid-feedback">
                  Please provide a course title.
                </div>
              </div>
            </div>

            <div class="row mb-3">
              <div class="col-12">
                <%= form.label :description, "Course Description", class: "form-label" %>
                <%= form.text_area :description, 
                    class: "form-control #{'is-invalid' if @course.errors[:description].any?}",
                    rows: 4,
                    placeholder: "Provide a detailed description of what students will learn in this course...",
                    required: true %>
                <div class="form-text">
                  Describe the course content, learning objectives, and target audience.
                </div>
              </div>
            </div>

            <div class="row mb-3">
              <div class="col-md-6">
                <%= form.label :price, "Course Price (USD)", class: "form-label" %>
                <div class="input-group">
                  <span class="input-group-text">$</span>
                  <%= form.number_field :price, 
                      class: "form-control #{'is-invalid' if @course.errors[:price].any?}",
                      step: 0.01,
                      min: 0,
                      placeholder: "0.00",
                      required: true %>
                </div>
                <div class="form-text">
                  Set to 0 for a free course.
                </div>
              </div>
              <div class="col-md-6">
                <%= form.label :thumbnail, "Course Thumbnail", class: "form-label" %>
                <%= form.file_field :thumbnail, 
                    class: "form-control #{'is-invalid' if @course.errors[:thumbnail].any?}",
                    accept: "image/*" %>
                <div class="form-text">
                  Upload an image to represent your course (optional).
                </div>
              </div>
            </div>

            <!-- Course Settings -->
            <hr class="my-4">
            <div class="row mb-4">
              <div class="col-12">
                <h5 class="text-primary mb-3">
                  <i class="fas fa-cogs me-2"></i>
                  Course Settings
                </h5>
              </div>
            </div>

            <div class="row mb-3">
              <div class="col-md-6">
                <div class="form-check form-switch">
                  <%= form.check_box :time_managed, 
                      class: "form-check-input #{'is-invalid' if @course.errors[:time_managed].any?}" %>
                  <%= form.label :time_managed, "Time-Managed Course", class: "form-check-label" %>
                </div>
                <div class="form-text">
                  Enable time tracking and deadlines for course completion.
                </div>
              </div>
              <div class="col-md-6">
                <div class="form-check form-switch">
                  <%= form.check_box :chapter_assessments_required, 
                      class: "form-check-input #{'is-invalid' if @course.errors[:chapter_assessments_required].any?}" %>
                  <%= form.label :chapter_assessments_required, "Require Chapter Assessments", class: "form-check-label" %>
                </div>
                <div class="form-text">
                  Students must complete chapter tests before final assessment.
                </div>
              </div>
            </div>

            <!-- Action Buttons -->
            <hr class="my-4">
            <div class="d-flex justify-content-between">
              <%= link_to instructor_courses_path, class: "btn btn-outline-secondary" do %>
                <i class="fas fa-times me-1"></i> Cancel
              <% end %>
              <%= form.submit "Create Course", class: "btn btn-primary" do %>
                <i class="fas fa-save me-1"></i> Create Course
              <% end %>
            </div>
          <% end %>
        </div>
      </div>

      <!-- Help Section -->
      <div class="card shadow mt-4">
        <div class="card-header bg-light">
          <h6 class="mb-0 text-primary">
            <i class="fas fa-lightbulb me-2"></i>
            Course Creation Tips
          </h6>
        </div>
        <div class="card-body">
          <div class="row">
            <div class="col-md-6">
              <h6>Course Structure</h6>
              <ul class="list-unstyled">
                <li><i class="fas fa-check text-success me-2"></i> Use clear, descriptive titles</li>
                <li><i class="fas fa-check text-success me-2"></i> Include learning objectives</li>
                <li><i class="fas fa-check text-success me-2"></i> Set appropriate pricing</li>
              </ul>
            </div>
            <div class="col-md-6">
              <h6>Assessment Strategy</h6>
              <ul class="list-unstyled">
                <li><i class="fas fa-check text-success me-2"></i> Consider chapter assessments</li>
                <li><i class="fas fa-check text-success me-2"></i> Enable time management if needed</li>
                <li><i class="fas fa-check text-success me-2"></i> Plan for compliance requirements</li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<style>
.shadow {
  box-shadow: 0 0.15rem 1.75rem 0 rgba(58, 59, 69, 0.15) !important;
}

.form-control:focus {
  border-color: #4e73df;
  box-shadow: 0 0 0 0.2rem rgba(78, 115, 223, 0.25);
}

.btn-primary {
  background-color: #4e73df;
  border-color: #4e73df;
}

.btn-primary:hover {
  background-color: #2e59d9;
  border-color: #2e59d9;
}
</style>

<script>
// Bootstrap form validation
(function() {
  'use strict';
  window.addEventListener('load', function() {
    var forms = document.getElementsByClassName('needs-validation');
    var validation = Array.prototype.filter.call(forms, function(form) {
      form.addEventListener('submit', function(event) {
        if (form.checkValidity() === false) {
          event.preventDefault();
          event.stopPropagation();
        }
        form.classList.add('was-validated');
      }, false);
    });
  }, false);
})();
</script>
