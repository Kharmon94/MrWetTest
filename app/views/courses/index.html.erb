      <!-- Page Header -->
      <div class="d-flex flex-column flex-md-row justify-content-between align-items-start align-items-md-center mb-4 mb-md-5">
        <div class="mb-3 mb-md-0">
          <% if user_signed_in? && !current_user.has_role?(:admin) %>
            <% if @show_all_courses %>
              <h1 class="display-4 fw-bold text-gradient mb-2">Browse All Courses</h1>
              <p style="color: var(--text-secondary);">Discover new courses to enhance your learning</p>
            <% else %>
              <h1 class="display-4 fw-bold text-gradient mb-2">My Courses</h1>
              <p style="color: var(--text-secondary);">Your enrolled and purchased courses</p>
            <% end %>
          <% elsif user_signed_in? && current_user.has_role?(:admin) %>
            <h1 class="display-4 fw-bold text-gradient mb-2">All Courses</h1>
            <p style="color: var(--text-secondary);">Manage all course offerings</p>
          <% else %>
            <h1 class="display-4 fw-bold text-gradient mb-2">Available Courses</h1>
            <p style="color: var(--text-secondary);">Sign in to access your courses or browse our offerings</p>
          <% end %>
        </div>
        <div class="d-flex flex-column flex-sm-row gap-2">
          <% if user_signed_in? && current_user.has_role?(:admin) %>
            <%= link_to "Add New Course", new_course_path, class: "btn btn-primary" %>
          <% elsif user_signed_in? && !current_user.has_role?(:admin) && @show_all_courses %>
            <%= link_to "My Courses", courses_path, class: "btn btn-outline-primary" %>
          <% end %>
        </div>
      </div>

<!-- Courses Grid -->
<% if @courses.any? %>
  <div class="row g-4">
    <% @courses.each do |course| %>
      <div class="col-lg-4 col-md-6">
        <div class="card h-100 glass-effect" style="background: var(--bg-secondary); border: 1px solid var(--border-primary);">
          <div class="card-body d-flex flex-column" style="color: var(--text-primary);">
            <div class="mb-3">
              <h5 class="card-title fw-bold" style="color: var(--text-primary);"><%= course.title %></h5>
              <p class="card-text" style="color: var(--text-secondary);"><%= truncate(course.description, length: 120) %></p>
            </div>
            
            <div class="mt-auto">
              <div class="d-flex justify-content-between align-items-center mb-3">
                <span class="badge <%= course.free? ? 'bg-success' : 'bg-primary' %> fs-6 px-3 py-2">
                  <%= course.formatted_price %>
                </span>
                <small style="color: var(--text-muted);">
                  <%= pluralize(course.lessons.count, 'lesson') %>
                </small>
              </div>
              
              <div class="d-grid gap-2">
                <% if user_signed_in? %>
                  <% if current_user.can_access?(course) %>
                    <%= link_to "Access Course", course_path(course),
                        class: "btn btn-success w-100" %>
                    <small class="text-center" style="color: var(--text-muted);">
                      <i class="fas fa-check-circle me-1"></i>Enrolled
                    </small>
                  <% elsif course.free? %>
                    <%= link_to "Enroll Free", course_path(course),
                        class: "btn btn-primary w-100" %>
                  <% else %>
                    <%= link_to "Purchase - #{course.formatted_price}",
                        new_payment_path(payable_type: 'Course', payable_id: course.id),
                        class: "btn btn-outline-primary w-100 text-truncate" %>
                  <% end %>
                <% else %>
                  <%= link_to "Sign In to Enroll", new_user_session_path,
                      class: "btn btn-outline-primary w-100" %>
                <% end %>
              </div>
            </div>
          </div>
        </div>
      </div>
    <% end %>
  </div>
<% else %>
  <div class="text-center py-5">
    <div class="mb-4">
      <% if user_signed_in? && !current_user.has_role?(:admin) %>
        <i class="fas fa-graduation-cap" style="font-size: 4rem; color: var(--text-muted);"></i>
      <% else %>
        <svg width="64" height="64" fill="currentColor" style="color: var(--text-muted);" viewBox="0 0 16 16">
          <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"/>
          <path d="M8 4a.5.5 0 0 1 .5.5v3h3a.5.5 0 0 1 0 1h-3v3a.5.5 0 0 1-1 0v-3h-3a.5.5 0 0 1 0-1h3v-3A.5.5 0 0 1 8 4z"/>
        </svg>
      <% end %>
    </div>
    
    <% if user_signed_in? && !current_user.has_role?(:admin) %>
      <% if @show_all_courses %>
        <h3 style="color: var(--text-primary);">No Courses Available</h3>
        <p style="color: var(--text-secondary);">Check back soon for new course offerings!</p>
      <% else %>
        <h3 style="color: var(--text-primary);">No Enrolled Courses Yet</h3>
        <p style="color: var(--text-secondary); margin-bottom: 1.5rem;">
          You haven't enrolled in any courses yet. Start your learning journey today!
        </p>
        <div class="d-flex flex-column flex-sm-row gap-3 justify-content-center align-items-center">
          <%= link_to "Browse All Courses", browse_courses_path, class: "btn btn-primary w-100 w-sm-auto" %>
          <% if user_signed_in? %>
            <%= link_to "My Progress", tests_test_attempts_path, class: "btn btn-outline-primary w-100 w-sm-auto" %>
          <% end %>
        </div>
      <% end %>
    <% else %>
      <h3 style="color: var(--text-primary);">No Courses Available</h3>
      <p style="color: var(--text-secondary);">Check back soon for new course offerings!</p>
    <% end %>
  </div>
<% end %>
