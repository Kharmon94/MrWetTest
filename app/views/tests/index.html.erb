<!-- Page Header -->
<div class="d-flex justify-content-between align-items-center mb-5">
  <div>
    <h1 class="display-4 fw-bold text-gradient mb-2">Available Tests</h1>
    <p class="text-white-50">Challenge yourself with our comprehensive test suite</p>
  </div>
  <% if user_signed_in? %>
    <%= link_to "My Test Attempts", tests_test_attempts_path, class: "btn btn-outline-primary" %>
  <% end %>
</div>

<!-- Tests Grid -->
<% if @tests.any? %>
  <div class="row g-4">
    <% @tests.each do |test| %>
      <div class="col-lg-6 col-md-6">
        <div class="card h-100 glass-effect" style="background: var(--bg-secondary); border: 1px solid var(--border-primary);">
          <div class="card-body d-flex flex-column" style="color: var(--text-primary);">
            <div class="mb-3">
              <h5 class="card-title fw-bold" style="color: var(--text-primary);"><%= test.title %></h5>
              <p class="card-text" style="color: var(--text-secondary);"><%= truncate(test.description, length: 150) %></p>
            </div>
            
            <div class="mb-3">
              <small style="color: var(--text-muted);">
                <strong>Instructions:</strong> <%= truncate(test.instructions, length: 100) %>
              </small>
            </div>
            
            <div class="mt-auto">
              <div class="d-flex justify-content-between align-items-center mb-3">
                <span class="badge <%= test.free? ? 'bg-success' : 'bg-primary' %> fs-6 px-3 py-2">
                  <%= test.formatted_price %>
                </span>
                <small style="color: var(--text-muted);">
                  <%= pluralize(test.questions.count, 'question') %>
                </small>
              </div>
              
              <div class="d-grid gap-2">
                <%= link_to "View Details", test_path(test), 
                    class: "btn btn-outline-primary" %>
                
                <% if user_signed_in? %>
                  <% if current_user.can_access?(test) %>
                    <%= link_to "Take Test", new_tests_test_attempt_path(test_id: test.id), 
                        class: "btn btn-primary" %>
                  <% elsif test.free? %>
                    <%= link_to "Take Free Test", new_tests_test_attempt_path(test_id: test.id), 
                        class: "btn btn-success" %>
                  <% else %>
                    <%= link_to "Purchase - #{test.formatted_price}", 
                        new_payment_path(payable_type: 'Test', payable_id: test.id), 
                        class: "btn btn-primary" %>
                  <% end %>
                <% else %>
                  <%= link_to "Sign In to Take Test", new_user_session_path, 
                      class: "btn btn-primary" %>
                <% end %>
              </div>
            </div>
          </div>
        </div>
      </div>
    <% end %>
  </div>
<% else %>
  <div class="text-center py-5">
    <div class="mb-4">
      <svg width="64" height="64" fill="currentColor" style="color: var(--text-muted);" viewBox="0 0 16 16">
        <path d="M8 1.783C7.015.936 5.587.81 4.287.94c-1.514.153-3.043.672-3.044 2.99v.089c0 1.046.464 2.03 1.272 2.696l-.971 1.02a.5.5 0 1 0 .743.668l1.02-.971a3.5 3.5 0 0 0 2.08.806c.823 0 1.55-.28 2.08-.806l1.02.971a.5.5 0 0 0 .743-.668l-.971-1.02c.808-.666 1.272-1.65 1.272-2.696v-.089c0-2.318-1.53-2.837-3.044-2.99-1.3-.13-2.728-.004-3.713.843z"/>
      </svg>
    </div>
    <h3 style="color: var(--text-primary);">No Tests Available</h3>
    <p style="color: var(--text-secondary);">Check back soon for new test offerings!</p>
  </div>
<% end %>
